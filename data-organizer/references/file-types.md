# 支持的文件类型

本文档详细说明 data-organizer 支持的文件类型及其处理方式。

## 文档类文件

### PDF (.pdf)

**处理方式**: 使用 `pdfplumber` 库提取纯文本内容

**输出内容**:
- 文档中所有页面的文本内容
- 按页面顺序排列，以空行分隔

**限制**:
- 仅提取可搜索文本，扫描版 PDF 需要 OCR 处理
- 不保留原始格式和布局
- 不提取图片中的文字

**安装依赖**:
```bash
pip install pdfplumber
```

### Microsoft Excel (.xlsx, .xls)

**处理方式**: 使用 `openpyxl` 库读取 Excel 文件

**输出内容**:
- 所有工作表内容
- 每个工作表标题 `[工作表: 名称]`
- 每行以 Tab 分隔各单元格值

**限制**:
- 不读取公式计算结果
- 不读取单元格格式和样式
- 大文件可能需要较长时间

**安装依赖**:
```bash
pip install openpyxl
```

### Microsoft Word (.docx)

**处理方式**: 使用 `python-docx` 库提取段落文本

**输出内容**:
- 所有段落文本
- 按文档中顺序排列
- 自动过滤空段落

**限制**:
- 不提取表格内容
- 不保留格式信息（粗体、斜体等）
- 不提取图片和嵌入对象

**安装依赖**:
```bash
pip install python-docx
```

## 数据类文件

### CSV (.csv)

**处理方式**: 使用 Python 内置 `csv` 模块读取

**输出内容**:
- 所有行数据
- 以逗号分隔各字段
- UTF-8 编码

**特性**:
- 自动处理多种 CSV 方言
- 支持带引号的字段

### JSON (.json)

**处理方式**: 使用 Python 内置 `json` 模块解析

**输出内容**:
- 格式化的 JSON 内容
- 保留缩进结构
- UTF-8 编码

## 文本类文件

### 纯文本 (.txt, .md, .log)

**处理方式**: 读取文件内容，自动检测编码

**支持编码**:
- UTF-8（优先）
- GBK / GB2312（中文）
- Latin-1（回退）

**输出内容**:
- 文件原始内容（去除首尾空白）

## 图片文件

### 支持格式 (.png, .jpg, .jpeg, .gif, .bmp)

**处理方式**: 使用 `Pillow` 库提取元数据

**输出内容**:
- 图片格式
- 尺寸（宽 x 高）
- 颜色模式
- EXIF 元数据（如有）

**EXIF 数据包含**:
- 拍摄日期
- 相机型号
- 拍摄参数
- GPS 坐标（如果有）

**安装依赖**:
```bash
pip install pillow
```

## 不支持的文件类型

以下文件类型暂不支持处理：
- 二进制文件 (.exe, .dll, .bin)
- 压缩文件 (.zip, .rar, .7z)
- 音频文件 (.mp3, .wav)
- 视频文件 (.mp4, .avi)
- 矢量图 (.svg, .eps)
- Adobe 文件 (.ai, .psd)
- 邮件文件 (.eml, .msg)

## 添加新文件类型

如需添加新的文件类型支持：

1. 在 `file_handler.py` 中添加文件扩展名到 `FILE_TYPE_MAP`
2. 创建对应的提取函数
3. 在 `process_file()` 函数中添加类型判断逻辑

## 文件类型自动检测

系统基于文件扩展名自动检测文件类型，而非文件内容。这意味着：
- 重命名文件可能导致类型识别错误
- 建议保持文件原始扩展名
